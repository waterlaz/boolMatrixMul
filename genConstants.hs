import Numeric

matrixNumber :: String -> Integer
matrixNumber s = foldl (\n c -> 2*n + digit c) 0 s
    where digit '0' = 0
          digit '1' = 1
          digit _ = error "Wrong binary digit"



empty      =   ["00000000",
                "00000000",
                "00000000",
                "00000000", 
                "00000000",
                "00000000",
                "00000000",
                "00000000"] 


top2       =   ["11111111",
                "11111111",
                "00000000",
                "00000000", 
                "11111111",
                "11111111",
                "00000000",
                "00000000"] 

lb2        =   ["00000000",
                "00000000",
                "11000000",
                "11000000", 
                "00000000",
                "00000000",
                "11000000",
                "11000000"] 

rb2        =   ["00000000",
                "00000000",
                "00111111",
                "00111111", 
                "00000000",
                "00000000",
                "00111111",
                "00111111"] 

top1       =   ["11111111",
                "00000000",
                "11111111",
                "00000000", 
                "11111111",
                "00000000",
                "11111111",
                "00000000"] 

lb1        =   ["00000000",
                "10000000",
                "00000000",
                "10000000", 
                "00000000",
                "10000000",
                "00000000",
                "10000000"] 

rb1        =   ["00000000",
                "01111111",
                "00000000",
                "01111111", 
                "00000000",
                "01111111",
                "00000000",
                "01111111"] 

selectRow1 =   ["11111111",
                "00000000",
                "00000000",
                "00000000", 
                "00000000",
                "00000000",
                "00000000",
                "00000000"] 


top4 =         ["11111111",
                "11111111",
                "11111111",
                "11111111", 
                "00000000",
                "00000000",
                "00000000",
                "00000000"] 


lb4        =   ["00000000",
                "00000000",
                "00000000",
                "00000000", 
                "11110000",
                "11110000",
                "11110000",
                "11110000"] 


rb4       =    ["00000000",
                "00000000",
                "00000000",
                "00000000", 
                "00001111",
                "00001111",
                "00001111",
                "00001111"] 


oddClm     =   ["10101010",
                "10101010",
                "10101010",
                "10101010", 
                "10101010",
                "10101010",
                "10101010",
                "10101010"] 

evenClm    =   ["01010101",
                "01010101",
                "01010101",
                "01010101", 
                "01010101",
                "01010101",
                "01010101",
                "01010101"] 

oddClm2    =   ["11001100",
                "11001100",
                "11001100",
                "11001100", 
                "11001100",
                "11001100",
                "11001100",
                "11001100"] 

evenClm2   =   ["00110011",
                "00110011",
                "00110011",
                "00110011", 
                "00110011",
                "00110011",
                "00110011",
                "00110011"] 

oddClm4    =   ["11110000",
                "11110000",
                "11110000",
                "11110000", 
                "11110000",
                "11110000",
                "11110000",
                "11110000"] 

evenClm4   =   ["00001111",
                "00001111",
                "00001111",
                "00001111", 
                "00001111",
                "00001111",
                "00001111",
                "00001111"] 



diag  =        ["10000000",
                "01000000",
                "00100000",
                "00010000", 
                "00001000",
                "00000100",
                "00000010",
                "00000001"] 

defs = [ ("Top4", top4),
         ("LB4", lb4),
         ("RB4", rb4),
         ("Top2", top2),
         ("LB2", lb2),
         ("RB2", rb2),
         ("Top1", top1),
         ("LB1", lb1),
         ("RB1", rb1),
         ("diag", diag),
         ("ODD_CLM", oddClm),
         ("EVEN_CLM", evenClm),
         ("ODD_CLM2", oddClm2),
         ("EVEN_CLM2", evenClm2),
         ("ODD_CLM4", oddClm4),
         ("EVEN_CLM4", evenClm4)]

define :: String -> [String] -> String
define literal m = comment  ++ "#define " ++ literal ++ " 0x" ++ showHex (matrixNumber (concat m)) ""
                where comment = unlines $ map (("/* "++).(++" */")) m


main = writeFile "constants.h" $ defString
   where defString = unlines $
            [ "/* Generated by genConstants.hs */",
              "/* Do not edit. */",
              "" ] ++
            map ((++"\n\n").(uncurry define)) defs
    
